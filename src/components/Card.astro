---
import type { CollectionEntry } from "astro:content";
import { slugifyStr } from "@/utils/slugify";
import { getPath, getPostPath } from "@/utils/getPath";
import Datetime from "./Datetime.astro";

type Props = {
  variant?: "h2" | "h3";
} & CollectionEntry<"blog">;

const { variant: Heading = "h2", id, data, filePath } = Astro.props;
const { title, description, tags, ...props } = data;
const href = getPath(`${getPostPath(id, filePath)}/`);
---

<li
  class="group my-4 rounded-xl border border-border p-5 transition-all hover:border-accent hover:shadow-sm"
>
  <!-- Tags -->
  {
    tags && tags.length > 0 && (
      <div class="mb-2 flex flex-wrap gap-1">
        {tags.slice(0, 3).map(tag => (
          <span class="rounded-full bg-accent/10 px-2 py-0.5 text-xs font-medium text-accent">
            {tag}
          </span>
        ))}
      </div>
    )
  }

  <!-- Título -->
  <a href={href} class="transition-colors group-hover:text-accent">
    <Heading
      class="mb-1 text-lg leading-snug font-semibold text-foreground transition-colors group-hover:text-accent"
      style={{ viewTransitionName: slugifyStr(title.replaceAll(".", "-")) }}
    >
      {title}
    </Heading>
  </a>

  <!-- Fecha -->
  <div class="mb-2">
    <Datetime {...props} />
  </div>

  <!-- Descripción -->
  <p class="text-sm leading-relaxed text-foreground/60">{description}</p>
</li>
